<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"class="no-webfont"><title>realazy: Opera 下 cloneNode 的 bug</title><meta charset="utf-8"><meta name="viewport"content="width=device-width,initial-scale=1,viewport-fit=cover"><link rel="alternate"href="http://feeds.feedburner.com/realazy"type="application/atom+xml"title="Realazy"><link rel="stylesheet"href="/assets/style.min.css"><body id="post"><header><h1><a href="/">真・懒</a></h1><section><span><a href="/feed.atom">订阅</a></span> <span><a href="https://twitter.com/_cxa">Twitter</a></span> <span><a href="https://github.com/cxa">GitHub</a></span> <span><a href="mailto:xianan.chen@gmail.com">联系</a></span></section></header><main><h1>Opera 下 cloneNode 的 bug</h1><section class="meta"><time datetime="2007-11-22">二〇〇七年十一月二十二日</time></section><p>Opera, 作为 <a href="http://developer.yahoo.com/yui/articles/gbs/#gbschart">A-Grade</a> 浏览器，在现在的前端开发中务必支持。它很优秀，很不幸，bug 是每个浏览器都不可避免的问题，Opera 亦难免。说说我发现的一个关于 <code>cloneNode</code> 的问题。<h2 id="">问题</h2><p>假设我们有一个 Form 节点（node）的引用，姑且名之为 <code>elForm</code>，现在需要克隆一份，可以这么做：<code>var elFormClone = elForm.cloneNode(true)</code>.<p>在插入这份克隆到 DOM 树中后，IE, Firefox 均未发现问题。Opera 会产生这样的问题：表单内的字段无法引用。比如，假设刚才我们的 <code>elForm</code> 有一个 <code>&lt;input name=&quot;title&quot; ... /&gt;</code>, 此时你无法通过 <code>elFormClone.title</code> 或者 <code>elFormClone[&#39;title&#39;]</code> 获取它。<h2 id="">解决方案</h2><p>使用 <code>document.createElement</code> 创建 form 元素，然后设置该元素的 <code>innerHTML</code>(感谢 MS 发明了它) 为 <code>elForm</code> 的 <code>innerHTML</code> 即可：<pre class="js"><code class="js">var elFormClone = document.createElement(&#39;form&#39;);
// 设置一些 elForm 的原属性，有必要的话
...
elFormClone.innerHTML = elForm.innerHTML;
// 处理这个 clone, 该咋办就咋办了
...</code></pre></main><footer><div class="intro"><img src="/assets/avatar.png"alt="头像"width="128"><p>我是陈贤安，喜欢钻研构建程序介面的技术，偏好静态类型函数式编程。常用编程语言有 JavaScript，会使 Swift、Objective-C、F# 和 OCaml。能看懂 C。realazy, 意取「真懒」，因为我相信，懒，对程序员来说，是一种美德。</div><p>2005 ～ 2022 © <span><a href="/">realazy</a></span> <span><a href="https://github.com/cxa/cxa.github.com.git">本站源码</a></span></footer><script src="/assets/highlight.js"></script><script src="/assets/script.js"></script>